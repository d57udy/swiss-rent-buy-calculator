<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post-Reform Demo</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .comparison { display: flex; gap: 20px; margin: 20px 0; }
        .result-box { border: 1px solid #ccc; padding: 15px; border-radius: 8px; flex: 1; }
        .current { border-left: 4px solid #007aff; }
        .reform { border-left: 4px solid #34c759; }
        button { background: #007aff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056cc; }
        .tax-details { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; font-size: 14px; }
    </style>
</head>
<body>
    <h1>Post-Reform Eigenmietwert Calculator Demo</h1>
    <p>This demo shows the difference between the current tax system and the proposed post-reform system (2027+).</p>
    
    <button onclick="runDemo()">Run Comparison Demo</button>
    
    <div id="results"></div>

    <script src="calculator.js"></script>
    <script>
        function runDemo() {
            // Demo parameters
            const params = {
                purchasePrice: 1200000,      // CHF 1.2M property
                downPayment: 240000,         // 20% down payment  
                mortgageRate: 0.018,         // 1.8% mortgage rate
                annualMaintenanceCosts: 15000,
                amortizationYears: 10,
                annualAmortization: 19200,
                totalRenovations: 0,
                additionalPurchaseCosts: 24000,
                imputedRentalValue: 26000,   // 65% of annual rent
                propertyTaxDeductions: 12000,
                marginalTaxRate: 0.26,       // 26% tax rate
                propertyAppreciationRate: 0.02,
                monthlyRent: 3300,           // CHF 3.3K rent
                annualRentalCosts: 6000,
                investmentYieldRate: 0.035,  // 3.5% investment yield
                termYears: 15,
                scenarioMode: 'equalConsumption'
            };
            
            // Calculate both scenarios
            const currentSystem = SwissRentBuyCalculator.calculate({ ...params, postReform: false });
            const postReformSystem = SwissRentBuyCalculator.calculate({ ...params, postReform: true });
            
            // Display results
            const resultsDiv = document.getElementById('results');
            
            const reformAdvantage = postReformSystem.ResultValue - currentSystem.ResultValue;
            const reformPercentage = ((reformAdvantage / Math.abs(currentSystem.ResultValue)) * 100);
            
            resultsDiv.innerHTML = `
                <h3>Comparison Results</h3>
                <div class="comparison">
                    <div class="result-box current">
                        <h4>Current Tax System (2025-2027)</h4>
                        <p><strong>Decision:</strong> ${currentSystem.Decision}</p>
                        <p><strong>Financial Impact:</strong> CHF ${Math.round(currentSystem.ResultValue).toLocaleString()}</p>
                        <div class="tax-details">
                            <strong>Tax Components (Year 1):</strong><br>
                            • Imputed Rental Tax: CHF ${Math.round(currentSystem.YearlyBreakdown[0].taxImputedRent).toLocaleString()}<br>
                            • Interest Deduction: -CHF ${Math.round(currentSystem.YearlyBreakdown[0].taxSavingsInterest).toLocaleString()}<br>
                            • Property Deduction: -CHF ${Math.round(currentSystem.YearlyBreakdown[0].taxSavingsPropertyExpenses).toLocaleString()}
                        </div>
                    </div>
                    
                    <div class="result-box reform">
                        <h4>Post-Reform System (2027+)</h4>
                        <p><strong>Decision:</strong> ${postReformSystem.Decision}</p>
                        <p><strong>Financial Impact:</strong> CHF ${Math.round(postReformSystem.ResultValue).toLocaleString()}</p>
                        <div class="tax-details">
                            <strong>Tax Components (Year 1):</strong><br>
                            • Imputed Rental Tax: CHF ${Math.round(postReformSystem.YearlyBreakdown[0].taxImputedRent).toLocaleString()}<br>
                            • Interest Deduction: -CHF ${Math.round(postReformSystem.YearlyBreakdown[0].taxSavingsInterest).toLocaleString()}<br>
                            • Property Deduction: -CHF ${Math.round(postReformSystem.YearlyBreakdown[0].taxSavingsPropertyExpenses).toLocaleString()}
                        </div>
                    </div>
                </div>
                
                <div style="background: #e8f4ff; border: 1px solid #007aff; border-radius: 8px; padding: 15px; margin: 20px 0;">
                    <h4 style="margin-top: 0; color: #007aff;">Reform Impact Summary</h4>
                    <p><strong>Reform makes buying CHF ${Math.round(Math.abs(reformAdvantage)).toLocaleString()} ${reformAdvantage > 0 ? 'MORE' : 'LESS'} attractive</strong></p>
                    <p>This represents a ${Math.abs(reformPercentage).toFixed(1)}% ${reformAdvantage > 0 ? 'improvement' : 'reduction'} in the financial advantage of buying.</p>
                    
                    <p><strong>Key Changes:</strong></p>
                    <ul>
                        <li>❌ <strong>No more Eigenmietwert tax</strong> (saves CHF ${Math.round(currentSystem.YearlyBreakdown[0].taxImputedRent).toLocaleString()}/year)</li>
                        <li>❌ <strong>No more mortgage interest deductions</strong> (loses CHF ${Math.round(currentSystem.YearlyBreakdown[0].taxSavingsInterest).toLocaleString()}/year)</li>
                        <li>❌ <strong>No more maintenance deductions</strong> (loses CHF ${Math.round(currentSystem.YearlyBreakdown[0].taxSavingsPropertyExpenses).toLocaleString()}/year)</li>
                    </ul>
                </div>
            `;
        }
    </script>
</body>
</html>